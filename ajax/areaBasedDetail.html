<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap 5 Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../js/javascript/common.js"></script>
  <title>지역기반 관광api사용 상세페이지 예시</title>
</head>
<script>
  // console.log('location.href',location.search, )
  const value = getParameter('contentid');
  // function baseurl (contentid) { return `http://apis.data.go.kr/B551011/KorService1/detailImage1?serviceKey=b9MNwPvft2noMOZrARW4LUhDn4wDhqMYjx4uVPz33VCQtVcbHzHBx6HGT%2BpTw1EoR1PoeZqZYyOaPTGO4qBf6w%3D%3D&numOfRows=10&MobileOS=ETC&MobileApp=AppTest&contentId=${contentid}&_type=json` }
  function baseurl (contentid) { return `http://apis.data.go.kr/B551011/KorService1/detailImage1?serviceKey=Y8spoZTd4XGG9NIZv6Q04TUKs7ktWz4SwTQPy5EdnUeTmjOt4zD6glXJHaJhn61eSz66u8sXKAXlFdNlNCIRNg%3D%3D&numOfRows=10&pageNo=1&MobileOS=ETC&MobileApp=AppTest&contentId=${contentid}&subImageYN=Y&imageYN=Y&_type=json` }

  $(function(){
    getTourData();
  })
  function getTourData() {
    // DB 이미지 정보 조회
    console.log(baseurl(value))
    $.ajax({
      url: baseurl(value),
      type: 'GET',
      dataType: 'json',
      // async: false, // 동기로 통신한다.
      success : function(data){
        console.log('success!', data)
        // debugger
        parsingJson(data);
        debugger
      }, 
      fail : function(data){
        console.log('fail!', data)
      }, 
      complete : function(data){
        console.log('complete!', data)

        // $('.loading').hide();
      }
    });

  }

  function parsingJson(data) {
    const targetItem = data.response.body.items.item;
    let html = `<div class="carousel-inner">`;

    for(let i in targetItem) {
      if(targetItem[i].originimgurl) {
        html += `<div class="carousel-item"><img src="${targetItem[i].originimgurl}" alt="${targetItem[i].imgname}" class="d-block" style="width:100%"></div>`
      }
    }

    html+=` </div>
            <div class="carousel-indicators">`;

    for(let i in targetItem) {
      if(targetItem[i].originimgurl) {
        html += `<button type="button" data-bs-target="#demo" data-bs-slide-to="${i}" class="${(i == 0) ? 'active' : ''}"></button>`
      }
    }
    html+=` </div>`;

    $('#demo').html(html)
  }
  
</script>
<style>
  .loading{
    display: none;
  }
  .list-group-item{
    display: flex;
  }
</style>
<body>

<div class="container-fluid p-5 bg-primary text-white text-center">
  <h1>tour api</h1>
  <p>Resize this responsive page to see the effect!</p> 
</div>

<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
  <div class="container-fluid">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a href="nav-link active" href="./index.html">홈</a>
      </li>
      <li class="nav-item">
        <a href="nav-link" href="./areaBasedList.html">홈</a>
      </li>
      <li class="nav-item">
        <a href="nav-link" href="#">link</a>
      </li>
      <li class="nav-item">
        <a href="nav-link disabled" href="#">disabled</a>
      </li>
    </ul>
  </div>
</nav>
  
<div class="container mt-5">
  <!-- Carousel -->
<div id="demo" class="carousel slide" data-bs-ride="carousel">
  
  <!-- Left and right controls/icons -->
  <button class="carousel-control-prev" type="button" data-bs-target="#demo" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#demo" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>
</div>

</body>
</html>
